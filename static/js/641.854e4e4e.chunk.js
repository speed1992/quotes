"use strict";(self.webpackChunkquotes=self.webpackChunkquotes||[]).push([[641],{641:function(e,t,r){r.r(t),r.d(t,{default:function(){return l}});var n=r(5861),s=r(4687),a=r.n(s),u=r(2791),o=r(295),c=function(){var e=(0,n.Z)(a().mark((function e(t){var r,s,u,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.userName,s=t.markedQuotes,u=t.openSnackbar,e.next=3,(0,o.YM)((0,n.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://quotes-backend.vercel.app/api/markedQuotes/backup",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({userName:r,markedQuotes:s,dateSynced:Date.now()})});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 3:return c=e.sent,e.next=6,c.json();case 6:c=e.sent,u("Auto-Sync :"+JSON.stringify(c));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i=function(){var e=(0,n.Z)(a().mark((function e(t){var r,s,u,c,i,p,d,l,f,k,m,v;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.userName,t.markedQuotes,u=t.openSnackbar,t.setMarkedQuotes,e.next=3,(0,o.YM)((0,n.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://quotes-backend.vercel.app/api/markedQuotes/restore",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({userName:s})});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 3:return c=e.sent,e.next=6,c.json();case 6:if(c=e.sent,null===(r=c)||void 0===r||!r.ok){e.next=20;break}if(e.prev=8,l=null===(i=c)||void 0===i||null===(p=i.results)||void 0===p||null===(d=p[0])||void 0===d?void 0:d.markedQuotes,f=Object.values(l).flat().length,!(l&&f>0)){e.next=13;break}return e.abrupt("return",{markedQuotesFromServer:l,dateFromServer:null===(k=c)||void 0===k||null===(m=k.results)||void 0===m||null===(v=m[0])||void 0===v?void 0:v.dateSynced});case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(8),u(JSON.stringify(e.t0));case 18:e.next=21;break;case 20:u(JSON.stringify(c.error));case 21:case"end":return e.stop()}}),e,null,[[8,15]])})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=(0,n.Z)(a().mark((function e(t){var r,s,u,c,i,p,d,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=t.apiCallType,u=t.userName,c=t.password,i=t.setIsLoggedIn,p=t.openSnackbar,d=u.charAt(0).toUpperCase()+u.slice(1),"login"!==s){e.next=8;break}return e.next=5,(0,o.YM)((0,n.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://quotes-backend.vercel.app/api/user/login",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({userName:u,password:c})});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 5:l=e.sent,e.next=11;break;case 8:return e.next=10,(0,o.YM)((0,n.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://quotes-backend.vercel.app/api/user/create",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({userName:u,password:c})});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))));case 10:l=e.sent;case 11:return e.next=13,l.json();case 13:l=e.sent,null!==(r=l)&&void 0!==r&&r.ok?(i(!0),p(d+" "+JSON.stringify(l.serverResponse))):p(JSON.stringify(l.error));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=r(184),l=function(e){var t=e.setUserName,r=e.userName,s=e.isLoggedIn,o=e.setIsLoggedIn,l=e.openSnackbar,f=e.markedQuotes,k=e.setMarkedQuotes,m=e.password,v=e.setPassword,h=r.charAt(0).toUpperCase()+r.slice(1);return(0,u.useEffect)((function(){s&&(0,n.Z)(a().mark((function e(){var t,n,s,u,o,p;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object.values(f).flat().length,e.next=3,i({userName:r,markedQuotes:f,openSnackbar:l,setMarkedQuotes:k});case 3:if(n=e.sent,s=n.markedQuotesFromServer,u=n.dateFromServer,!s){e.next=21;break}if(!((o=Object.values(s).flat().length)>t)){e.next=13;break}k(s),l("Auto-Sync :Restored all marked quotes!",2e3),e.next=21;break;case 13:if(!(t>o)){e.next=21;break}if((p=new Date).setHours(0,0,0,0),(u=new Date(u)).setHours(0,0,0,0),!(p>u)){e.next=21;break}return e.next=21,c({userName:r,markedQuotes:f,openSnackbar:l});case 21:case"end":return e.stop()}}),e)})))()}),[]),(0,d.jsx)(d.Fragment,{children:s?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"userName",children:["Hi ",h,"!"]}),(0,d.jsx)("button",{className:"menuBtn",onClick:function(){return o(!1)},children:"Logout"})]}):(0,d.jsxs)(d.Fragment,{children:["Username",(0,d.jsx)("input",{type:"text",className:"userInput",onChange:function(e){return t(e.target.value)},value:r}),"Password",(0,d.jsx)("input",{type:"password",className:"userInput",onChange:function(e){return v(e.target.value)},value:m}),(0,d.jsx)("button",{className:"menuBtn",onClick:function(){return p({apiCallType:"login",userName:r,password:m,setIsLoggedIn:o,openSnackbar:l})},children:"Login"}),(0,d.jsx)("button",{className:"menuBtn",onClick:function(){return p({apiCallType:"register",userName:r,password:m,setIsLoggedIn:o,openSnackbar:l})},children:"Register"})]})})}}}]);
//# sourceMappingURL=641.854e4e4e.chunk.js.map